#include "compile.h"
#include "stc89xx.h"
#include <public.h>
#include <uart.h>
#include <MatrixLED8_8.h>


int main(void)
{   
    Uart1_Init(RELOAD_COUNT);
    MatrixLED_Init();
    CodeArray(hello,0xFF,0x10,0x10,0x10,0xFF,0x00,0x3E,0x49,0x49,0x49,0x39,0x00,0x00,0x00,0xFE,0x01,
        0x01,0x02,0x00,0x00,0xFE,0x01,0x01,0x02,0x00,0x1E,0x21,0x21,0x21,0x1E,0x00,0x00);
    CodeArray(kunkun, 0x00,0x01,0x1E,0x3E,0x7B,0x40,0x00,0x00,
      0x00,0x09,0x1E,0x3E,0x2D,0x00,0x00,0x00,
      0x00,0x01,0x1F,0x1F,0x3F,0x20,0x00,0x00,
      0x00,0x09,0x1E,0x3E,0x2D,0x00,0x00,0x00,
      0x00,0x01,0x1E,0x3E,0x7B,0x40,0x00,0x00,
      0x00,0x09,0x1E,0x3E,0x2D,0x00,0x00,0x00,
      0x00,0x01,0x1F,0x1F,0x3F,0x20,0x00,0x00,
      0x00,0x11,0x2B,0x3C,0xFF,0xF1,0x16,0x0E,0x00,0x11,0x2B,0x3C,0xFF,0xF1,0x13,0x0B,
      0x00,0x11,0x2B,0x3C,0xFF,0xF1,0x16,0x0E,0x00,0x11,0x2B,0x3C,0xFF,0xF1,0x13,0x0B);
    
    static __code DynamicLED_Params params1={hello,8,1,20};
    static __code DynamicLED_Params params2={kunkun,8,8,15};
    static   LoopFunction_t tasks[3] ={
        {Dynamic_MatrixLED,&params1,END},
        {Dynamic_MatrixLED,&params2,END},
        {Uart1_MainFunction,NULL,RUNNING}
    };
    static TaskContext_t context = { tasks, 3 };
    tasks[2].params = &context;

    Task_init(context.tasks,3);

    Loop_Tasks();
    
    return 0;
}